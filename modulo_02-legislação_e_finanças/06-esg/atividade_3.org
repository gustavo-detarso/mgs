#+LANGUAGE: pt_BR
#+OPTIONS: toc:nil num:nil
#+LATEX_CLASS: article
#+LATEX_CLASS_OPTIONS: [12pt]
#+LATEX_COMPILER: lualatex

# ---- Tipografia e idioma
#+LATEX_HEADER: \usepackage{fontspec}
#+LATEX_HEADER: \defaultfontfeatures{Ligatures=TeX}
#+LATEX_HEADER: \setmainfont{Times New Roman}[
#+LATEX_HEADER:   Path = /usr/share/fonts/truetype/msttcorefonts/,
#+LATEX_HEADER:   Extension = .ttf,
#+LATEX_HEADER:   UprightFont = Times_New_Roman,
#+LATEX_HEADER:   BoldFont = Times_New_Roman_Bold,
#+LATEX_HEADER:   ItalicFont = Times_New_Roman_Italic,
#+LATEX_HEADER:   BoldItalicFont = Times_New_Roman_Bold_Italic
#+LATEX_HEADER: ]
#+LATEX_HEADER: \usepackage[brazil]{babel}

# ---- Página e parágrafo
#+LATEX_HEADER: \usepackage[a4paper,margin=3cm]{geometry}
#+LATEX_HEADER: \linespread{1.5}
#+LATEX_HEADER: \setlength{\parskip}{0.7em}
#+LATEX_HEADER: \setlength{\parindent}{0pt}

# ---- Links e cores (opcional)
#+LATEX_HEADER: \usepackage{xcolor}
#+LATEX_HEADER: \usepackage{hyperref}
#+LATEX_HEADER: \hypersetup{colorlinks=true, linkcolor=black, urlcolor=blue, citecolor=black}
#+LATEX_HEADER: \newcommand{\blueunder}[2][0.5pt]{%
#+LATEX_HEADER:   {\vspace{-1.2cm}\centering\color{blue}\rule{#2}{#1}\par}%
#+LATEX_HEADER: }

# ---- Tabelas (Tabularray)
#+LATEX_HEADER: \usepackage{tabularray}
#+LATEX_HEADER: \UseTblrLibrary{booktabs}
#+LATEX_HEADER: \SetTblrInner{rowsep=1pt,colsep=4pt}
#+LATEX_HEADER: \renewcommand{\arraystretch}{1.0}

# ---- Caixa/“cartão” (visual de ficha)
#+LATEX_HEADER: \usepackage[most]{tcolorbox}
#+LATEX_HEADER: \tcbset{boxrule=0.6pt, arc=2mm, colframe=black!50, colback=white, left=3pt, right=2pt, top=3pt, bottom=2pt}

#+ATTR_LATEX: :height 2cm :center t
[[/home/gustavodetarso/Documentos/.share/mgs_org/fgv.png]]
#+LATEX: \blueunder{0.5\linewidth}

#+LATEX: {\centering\color{blue}\itshape MBA Gestão em Saúde\par}

#+begin_export latex
\begingroup
\linespread{1}\selectfont
\begin{tcolorbox}[title=Dados da obra,
colback=gray!5,colframe=gray!40,boxrule=0.4pt,sharp corners]
\begin{tblr}[rowsep=1pt,stretch=1]{rows={t}, colspec={Q[l,2.8cm] X[l]}}
\textbf{Autor(es)}   & Adriana Maria André \\
\textbf{Título}      & Gestão de Clínicas, Hospitais e Indústrias da Saúde \\
\textbf{Edição}      & 3. ed. \\
\textbf{Publicação}  & Rio de Janeiro: Atheneu, 2022 \\
\textbf{Páginas}     & 362 p.; il.; 24 cm \\
\textbf{ISBN}        & 978-65-5586-540-0 \\
\textbf{Assuntos}    & 1. Administração dos serviços de saúde. 2. Administração da produção - Saúde \\
\textbf{Resumo}      & O capítulo defende que a gestão em saúde deve transcender o lucro e integrar ética, responsabilidade social e ambiental como pilares de sustentabilidade. Propõe um novo paradigma em que o desempenho das organizações seja medido pela coerência entre resultados econômicos e compromisso com a vida e o bem comum. \\
\end{tblr}
\end{tcolorbox}
\endgroup
#+end_export
#+LATEX: \linespread{1.5}\selectfont

ATIVIDADE 3 - Plano de Ação: Valores Universalizáveis em Saúde (8,00 pontos)
Prazo: 21/11/2025, até 23:59h
Trabalho em grupo OU individual

Desenvolvam um plano de ação para implementar práticas relacionadas aos valores universalizáveis em uma empresa de saúde brasileira (pode ser real ou fictícia).

O que entregar:
- Um plano estruturado utilizando a metodologia 5W2H (ou outra metodologia de sua escolha, desde que devidamente justificada).

Requisitos:

- O plano deve ser específico e exequível - evite propostas genéricas ou abstratas
- Demonstre viabilidade prática: considere recursos, prazos realistas, responsáveis e custos
- Formato preferencial: Apresentação em PowerPoint (mas outros formatos são aceitos: Word, PDF, etc.)
- Seja pragmático: queremos ver um plano que possa efetivamente ser implementado

Dica: Pense em uma organização de saúde específica (hospital, clínica, laboratório, operadora) e adapte o plano à realidade deste tipo de instituição.

#+LATEX: \vspace{1cm}
#+LATEX: \blueunder{0.5\linewidth}



#+NAME: estatisticas-texto
#+begin_src python :results value raw :exports results :var fname=(buffer-file-name)
  import pathlib
  import re
  import subprocess

  path = pathlib.Path(fname)
  text = path.read_text(encoding="utf-8")
  lines = text.splitlines()

  # 1) Achar o ÚLTIMO bloco:
  #    #+LATEX: \vspace{1cm}
  #    #+LATEX: \blueunder{...}
  start_idx = None
  i = 0
  while i < len(lines):
      if lines[i].strip() == "#+LATEX: \vspace{1cm}":
          j = i + 1
          while j < len(lines) and "\blueunder" not in lines[j]:
              j += 1
          if j < len(lines):
              start_idx = j + 1  # texto começa na linha seguinte ao blueunder
              i = j + 1
              continue
      i += 1

  if start_idx is None or start_idx >= len(lines):
      return "* Estatísticas do texto\nProblema: marcador não encontrado.\n"

  body_lines = lines[start_idx:]

  # 2) Limpar: ignorar diretivas, blocos de código e estatísticas antigas
  clean = []
  skip_stats = False
  inside_code = False

  for l in body_lines:
      ls = l.lstrip()
      if ls.startswith("* Estatísticas do texto"):
          skip_stats = True
          continue
      if skip_stats:
          continue

      if ls.lower().startswith("#+begin_src"):
          inside_code = True
          continue
      if ls.lower().startswith("#+end_src"):
          inside_code = False
          continue
      if inside_code:
          continue

      if ls.startswith("#+"):
          continue

      clean.append(l)

  body = "\n".join(clean)

  # 3) Contar palavras, linhas (Org) e parágrafos
  words = len(re.findall(r"\S+", body))
  lines_count = sum(1 for l in body.splitlines() if l.strip())

  paras = 0
  in_para = False
  for l in body.splitlines():
      if l.strip():
          if not in_para:
              paras += 1
              in_para = True
      else:
          in_para = False

  # 4) Linhas no PDF via script externo (FGV)
  pdf = path.with_suffix(".pdf")
  pdf_lines = None
  try:
      cmd = [
          "/home/gustavodetarso/.local/bin/conta_linhas_pdf.sh",  # ajuste se usar outro caminho
          str(pdf),
          "--keep-blank",
          "--preset",
          "fgv",
      ]
      out = subprocess.check_output(cmd, text=True)
      for line in out.splitlines():
          line = line.strip()
          if line.startswith("TOTAL:"):
              parts = line.split()
              pdf_lines = int(parts[-1])
              break
  except Exception:
      pdf_lines = None

  # 5) Saída em formato de lista Org (um item por linha no PDF)
  res = "* Estatísticas do texto\n"
  res += f"- Palavras (Org): {words}\n"
  if pdf_lines is not None:
      res += f"- Linhas (PDF, FGV): {pdf_lines}\n"
  else:
      res += "- Linhas (PDF, FGV): erro ao chamar o script\n"
  res += f"- Parágrafos (Org): {paras}\n"

  return res
  #+end_src

